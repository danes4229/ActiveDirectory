Get-ADUser -Filter * -Properties * | Select-Object -Property * -ExcludeProperty MemberOf | 
    Select-Object *,@{Name="MemberOf";Expression={(Get-ADPrincipalGroupMembership $_).Name -join ', '}} |
    Format-List
Este comando realiza lo siguiente:

Obtiene todas las propiedades extendidas de todos los usuarios en Active Directory, excluyendo la propiedad "MemberOf".
Luego, agrega una nueva propiedad llamada "MemberOf" que muestra todos los grupos a los que pertenece cada usuario, utilizando el cmdlet Get-ADPrincipalGroupMembership.
Finalmente, muestra la salida en formato de lista detallada.
Este comando proporcionará una salida completa con todas las propiedades extendidas de cada usuario, incluyendo la lista de grupos a los que pertenecen. Ten en cuenta que la salida puede ser muy extensa y podría ser difícil de leer en la línea de comandos, por lo que es recomendable redirigirla a un archivo o utilizar herramientas de visualización de texto para un análisis más cómodo.





